---
import { SITE } from "@config/site";

type Props = {
  currentPathname: string;
};

const { currentPathname } = Astro.props as Props;

const NAV = [
  { name: "ブログ", href: "/posts" },
  { name: "ポートフォリオ", href: "/use-cases" },
  { name: "自己紹介", href: "/about" },
] as const;

const isActive = (href: string): boolean => {
  if (href === "/") return currentPathname === "/";
  if (currentPathname === href) return true;
  return currentPathname.startsWith(`${href}/`);
};
---

<header class="sticky top-0 z-50 w-full border-b border-white/10 bg-slate-950/70 backdrop-blur-md">
  <nav class="container mx-auto flex h-16 items-center justify-between px-4 sm:px-6 lg:px-8">
    <a href="/" class="flex items-center gap-3 rounded-lg px-2 py-1 hover:bg-white/5 transition-colors">
      <span class="inline-flex h-9 w-9 items-center justify-center rounded-lg bg-linear-to-br from-blue-600 to-teal-600 text-white font-mono text-sm">
        {"</>"}
      </span>
      <span class="text-base sm:text-lg font-bold text-slate-100">{SITE.title}</span>
    </a>

    <!-- Desktop nav -->
    <div class="hidden lg:flex items-center gap-1">
      {NAV.map((item) => {
        const active = isActive(item.href);
        return (
          <a
            href={item.href}
            class={`relative rounded-lg px-3 py-2 text-sm font-medium transition-colors ${
              active ? "text-white" : "text-slate-200/80 hover:text-slate-100"
            } hover:bg-white/5`}
            aria-current={active ? "page" : undefined}
          >
            {item.name}
            {active && (
              <span class="absolute -bottom-1 left-1/2 h-1 w-1 -translate-x-1/2 rounded-full bg-blue-300"></span>
            )}
          </a>
        );
      })}
    </div>

    <!-- Mobile nav (JS不要) -->
    <details class="relative lg:hidden">
      <summary
        class="list-none rounded-lg p-2 text-slate-100 hover:bg-white/5 focus:outline-none focus:ring-2 focus:ring-blue-400/60"
        aria-label="メニューを開く"
      >
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="opacity-90" aria-hidden="true">
          <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
      </summary>

      <div class="absolute right-0 mt-3 w-56 overflow-hidden rounded-xl border border-white/10 bg-slate-950/95 shadow-2xl">
        <div class="p-2">
          {NAV.map((item) => {
            const active = isActive(item.href);
            return (
              <a
                href={item.href}
                class={`block rounded-lg px-3 py-2 text-sm ${
                  active
                    ? "bg-white/5 text-white"
                    : "text-slate-200/80 hover:bg-white/5 hover:text-slate-100"
                } transition-colors`}
                aria-current={active ? "page" : undefined}
              >
                {item.name}
              </a>
            );
          })}
        </div>
      </div>
    </details>
  </nav>
</header>
